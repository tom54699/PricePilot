# 需求文件

## 介紹

報價計算系統基礎功能旨在修復和改善現有的軟體開發專案報價計算工具，提供穩定可靠的核心功能。此系統將幫助軟體開發公司快速、準確地為客戶生成基本的報價單，專注於核心計算邏輯和基本輸出功能。

## 需求

### 需求 1

**用戶故事：** 作為一名開發人員，我希望修復現有代碼中的語法錯誤和縮排問題，以便系統能夠正常運行。

#### 驗收標準

1. WHEN 系統載入 PriceCalculator 類別 THEN 系統 SHALL 不產生任何語法錯誤
2. WHEN 系統執行 create_quote 方法 THEN 系統 SHALL 正確計算並返回報價資料
3. WHEN 系統執行 export_to_excel 方法 THEN 系統 SHALL 成功生成 Excel 檔案
4. WHEN 執行 example_usage.py THEN 系統 SHALL 完整執行並顯示報價結果

### 需求 2

**用戶故事：** 作為一名專案經理，我希望能夠輸入基本的專案資訊和任務清單，以便快速生成報價單。

#### 驗收標準

1. WHEN 用戶提供專案名稱和客戶名稱 THEN 系統 SHALL 將資訊包含在報價單中
2. WHEN 用戶輸入任務清單 THEN 系統 SHALL 驗證每個任務包含必要的欄位（類型、工時）
3. WHEN 任務類型不存在於預設清單中 THEN 系統 SHALL 使用預設的中級開發費率
4. IF 工時為零或負數 THEN 系統 SHALL 將該任務工時設為零並繼續計算

### 需求 3

**用戶故事：** 作為一名業務人員，我希望系統能夠正確計算每個任務的價格，以便提供準確的報價。

#### 驗收標準

1. WHEN 系統計算任務價格 THEN 系統 SHALL 根據任務類型、複雜度和風險等級計算調整後時薪
2. WHEN 系統計算小計 THEN 系統 SHALL 將調整後時薪乘以工時得出正確金額
3. WHEN 系統計算總計 THEN 系統 SHALL 加總所有任務小計和額外費用
4. WHEN 系統計算稅額 THEN 系統 SHALL 以 5% 稅率計算營業稅

### 需求 4

**用戶故事：** 作為一名業務人員，我希望能夠匯出 Excel 格式的報價單，以便與客戶分享和存檔。

#### 驗收標準

1. WHEN 用戶匯出報價單 THEN 系統 SHALL 生成包含兩個工作表的 Excel 檔案
2. WHEN 系統生成報價摘要工作表 THEN 系統 SHALL 包含專案資訊、費用明細和總計
3. WHEN 系統生成詳細項目工作表 THEN 系統 SHALL 包含所有任務的詳細計算資訊
4. WHEN 匯出完成 THEN 系統 SHALL 顯示檔案儲存位置並確認匯出成功